clear
Data = ...
    [0.010   32.9538
    0.012    33.8790
    0.014    33.8421
    0.016    34.1185
    0.019    34.5934
    0.023    34.9390
    0.026    35.2520
    0.031    35.7485
    0.037    36.0697
    0.043    36.4345
    0.051    36.6511
    0.060    37.1580
    0.070    37.4301
    0.082    37.9566
    0.097    38.2532
    0.114    38.6128
    0.134    39.0678
    0.158    39.3414
    0.186    39.7921
    0.218    40.1565
    0.257    40.5649
    0.302    40.9052
    0.355    41.4214
    0.418    41.7909
    0.491    42.2314
    0.578    42.6170
    0.679    43.0527
    0.799    43.5041
    0.940    43.9725
    1.105    44.5140
    1.300    44.8218];
err = (10^-6).*[145.9 167.8 78.5 72.35 85.5 56.1 61.1 56.8 56.8 75.1 92.9 62.1 65.9 54.6 59.9 37.4 38.6 34.7 32.1 33.0 31.7 39.3 33.6 41.5 39.4 35.9 62.8 54.6 66.8 154.6 138.5];
truerr = (10^-6).*[21282 28155 6162 5235 7303 3150 3729 3222 3225 5646 8630 3855 4340 2986 3592 1401 1491 1203 1032 1086 1006 1541 1127 1723 1550 1292 3941 2980 4465 23902 19169];
z = Data(:,1);
mu = Data(:,2);
h=0.7;
k = linspace(0,1);
s(1:length(k))=0;
for i = 1:length(z)
Z=z(i);
E=truerr(i);
for j = 1:length(k) 
OmegaL= k(j);     
theory(i)= 25+5*log10(2997.92458*integral(@(x) 1./(OmegaL+(1-OmegaL).*(1+x).^3).^(1/2), 0,Z)*(1+Z)/h);
s(j) = s(j) + ((mu(i)-theory(i)).^2)/(E);
end
end
indexmin = find(min(s)==s);
kmin = k(indexmin);
smin = s(indexmin);
plot(k,s)
title('Finding the curve of best fit with respect to {\Omega}_{\Lambda}')
xlabel('{\Omega}_{\Lambda}')
ylabel('{\chi}^2')
fprintf('chi is smallest at OmegaL = %f with a value of %f. \n' ,kmin,smin)
